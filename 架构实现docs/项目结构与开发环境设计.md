# Cascade é¡¹ç›®ç»“æ„ä¸å¼€å‘ç¯å¢ƒè®¾è®¡

## 1. é¡¹ç›®ç»“æ„æ¦‚è§ˆ

### 1.1 åŠŸèƒ½æ¨¡å—ä¼˜å…ˆçš„é¡¹ç›®ç»“æ„

åŸºäºä¹‹å‰å®Œæˆçš„é‡æ„æ¶æ„è®¾è®¡ï¼Œé‡‡ç”¨åŠŸèƒ½æ¨¡å—ä¼˜å…ˆçš„æ‰å¹³åŒ–ç»“æ„ï¼š

```
cascade/
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ LICENSE                     # Apache 2.0 è®¸å¯è¯
â”œâ”€â”€ CHANGELOG.md                # ç‰ˆæœ¬å˜æ›´æ—¥å¿—
â”œâ”€â”€ CONTRIBUTING.md             # è´¡çŒ®æŒ‡å—
â”œâ”€â”€ .gitignore                  # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .python-version             # Pythonç‰ˆæœ¬é”å®š
â”‚
â”œâ”€â”€ cascade/                    # æ ¸å¿ƒåŒ…ç›®å½•
â”‚   â”œâ”€â”€ __init__.py             # åŒ…åˆå§‹åŒ–ï¼Œæ ¸å¿ƒAPIæš´éœ²
â”‚   â”œâ”€â”€ types.py                # pydanticç±»å‹ç³»ç»Ÿï¼ˆé›¶ä¾èµ–ï¼‰
â”‚   â”œâ”€â”€ formats.py              # éŸ³é¢‘æ ¼å¼å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ buffer.py               # éŸ³é¢‘ç¼“å†²åŒºæ¨¡å—
â”‚   â”œâ”€â”€ processor.py            # éŸ³é¢‘å¤„ç†å™¨æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ backends/               # VADåç«¯å®ç°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py             # æŠ½è±¡åŸºç±»
â”‚   â”‚   â”œâ”€â”€ onnx.py             # ONNXåç«¯å®ç°
â”‚   â”‚   â””â”€â”€ vllm.py             # VLLMåç«¯å®ç°
â”‚   â”‚   â””â”€â”€ silero.py           # sileroåç«¯å®ç°
â”‚   â”œâ”€â”€ _internal/              # å†…éƒ¨å®ç°æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ atomic.py           # åŸå­æ“ä½œå·¥å…·
â”‚   â”‚   â”œâ”€â”€ thread_pool.py      # çº¿ç¨‹æ± ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ performance.py      # æ€§èƒ½ç›‘æ§
â”‚   â”‚   â””â”€â”€ utils.py            # å†…éƒ¨å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ py.typed                # ç±»å‹æ ‡æ³¨å£°æ˜
â”‚
â”œâ”€â”€ tests/                      # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py             # pytesté…ç½®
â”‚   â”œâ”€â”€ unit/                   # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ test_types.py       # ç±»å‹ç³»ç»Ÿæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_formats.py     # æ ¼å¼å¤„ç†æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_buffer.py      # ç¼“å†²åŒºæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_processor.py   # å¤„ç†å™¨æµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_backends.py    # åç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ integration/            # é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ test_end_to_end.py  # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_performance.py # æ€§èƒ½æµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_real_audio.py  # çœŸå®éŸ³é¢‘æµ‹è¯•
â”‚   â”œâ”€â”€ benchmarks/             # æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ test_latency.py     # å»¶è¿ŸåŸºå‡†
â”‚   â”‚   â”œâ”€â”€ test_throughput.py  # ååé‡åŸºå‡†
â”‚   â”‚   â””â”€â”€ test_memory.py      # å†…å­˜ä½¿ç”¨åŸºå‡†
â”‚   â””â”€â”€ fixtures/               # æµ‹è¯•æ•°æ®
â”‚       â”œâ”€â”€ audio_samples/      # éŸ³é¢‘æ ·æœ¬æ–‡ä»¶
â”‚       â””â”€â”€ expected_results/   # æœŸæœ›ç»“æœæ–‡ä»¶
â”‚
â”œâ”€â”€ examples/                   # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ basic_usage.py          # åŸºç¡€ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ streaming_demo.py       # æµå¼å¤„ç†ç¤ºä¾‹
â”‚   â”œâ”€â”€ performance_tuning.py   # æ€§èƒ½è°ƒä¼˜ç¤ºä¾‹
â”‚   â”œâ”€â”€ custom_backend.py       # è‡ªå®šä¹‰åç«¯ç¤ºä¾‹
â”‚   â””â”€â”€ audio_files/            # ç¤ºä¾‹éŸ³é¢‘æ–‡ä»¶
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ index.md                # æ–‡æ¡£é¦–é¡µ
â”‚   â”œâ”€â”€ api/                    # APIæ–‡æ¡£ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ tutorials/              # æ•™ç¨‹æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ getting_started.md  # å¿«é€Ÿå¼€å§‹
â”‚   â”‚   â”œâ”€â”€ advanced_usage.md   # é«˜çº§ç”¨æ³•
â”‚   â”‚   â””â”€â”€ performance_guide.md # æ€§èƒ½æŒ‡å—
â”‚   â”œâ”€â”€ architecture/           # æ¶æ„æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ overview.md         # æ¶æ„æ¦‚è§ˆ
â”‚   â”‚   â”œâ”€â”€ modules.md          # æ¨¡å—è®¾è®¡
â”‚   â”‚   â””â”€â”€ performance.md      # æ€§èƒ½è®¾è®¡
â”‚   â””â”€â”€ assets/                 # æ–‡æ¡£èµ„æº
â”‚
â”œâ”€â”€ scripts/                    # å¼€å‘è„šæœ¬
â”‚   â”œâ”€â”€ setup_dev.py            # å¼€å‘ç¯å¢ƒè®¾ç½®
â”‚   â”œâ”€â”€ run_tests.py            # æµ‹è¯•è¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ check_performance.py    # æ€§èƒ½æ£€æŸ¥è„šæœ¬
â”‚   â””â”€â”€ generate_docs.py        # æ–‡æ¡£ç”Ÿæˆè„šæœ¬
â”‚
â”œâ”€â”€ .github/                    # GitHubé…ç½®
â”‚   â”œâ”€â”€ workflows/              # GitHub Actionså·¥ä½œæµ
â”‚   â”‚   â”œâ”€â”€ ci.yml              # æŒç»­é›†æˆ
â”‚   â”‚   â”œâ”€â”€ release.yml         # å‘å¸ƒæµç¨‹
â”‚   â”‚   â””â”€â”€ docs.yml            # æ–‡æ¡£æ„å»º
â”‚   â”œâ”€â”€ ISSUE_TEMPLATE/         # Issueæ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ bug_report.md       # BugæŠ¥å‘Šæ¨¡æ¿
â”‚   â”‚   â””â”€â”€ feature_request.md  # åŠŸèƒ½è¯·æ±‚æ¨¡æ¿
â”‚   â””â”€â”€ pull_request_template.md # PRæ¨¡æ¿
â”‚
â”œâ”€â”€ .devcontainer/              # å¼€å‘å®¹å™¨é…ç½®
â”‚   â”œâ”€â”€ devcontainer.json       # å®¹å™¨é…ç½®
â”‚   â””â”€â”€ Dockerfile              # å¼€å‘ç¯å¢ƒé•œåƒ
â”‚
â””â”€â”€ .vscode/                    # VSCodeé…ç½®
    â”œâ”€â”€ settings.json           # ç¼–è¾‘å™¨è®¾ç½®
    â”œâ”€â”€ launch.json             # è°ƒè¯•é…ç½®
    â””â”€â”€ extensions.json         # æ¨èæ‰©å±•
```

### 1.2 è®¾è®¡åŸåˆ™

- **åŠŸèƒ½æ¨¡å—ä¼˜å…ˆ**ï¼šæ¯ä¸ªæ¨¡å—ä¸“æ³¨å•ä¸€èŒè´£
- **æ‰å¹³åŒ–ç»“æ„**ï¼šå‡å°‘åµŒå¥—å±‚æ¬¡ï¼Œé™ä½ç†è§£æˆæœ¬
- **æ¸…æ™°è¾¹ç•Œ**ï¼šå…¬å¼€APIä¸å†…éƒ¨å®ç°æ˜ç¡®åˆ†ç¦»
- **å¼€å‘è€…ä½“éªŒ**ï¼šå®Œæ•´çš„å¼€å‘å·¥å…·é“¾å’Œè‡ªåŠ¨åŒ–æµç¨‹

## 2. æ ¸å¿ƒåŒ…ç»“æ„è®¾è®¡

### 2.1 cascade/ åŒ…ç»“æ„

```python
# cascade/__init__.py - æ ¸å¿ƒAPIæš´éœ²
"""
Cascade: é«˜æ€§èƒ½å¼‚æ­¥å¹¶è¡ŒVADå¤„ç†åº“

æä¾›ä½å»¶è¿Ÿã€é«˜ååé‡çš„è¯­éŸ³æ´»åŠ¨æ£€æµ‹èƒ½åŠ›ï¼Œæ”¯æŒå¤šç§VADåç«¯å’ŒéŸ³é¢‘æ ¼å¼ã€‚
"""

from .types import (
    AudioConfig, VADConfig, AudioChunk, VADResult, 
    PerformanceMetrics, AudioFormat, VADBackend
)
from .processor import VADProcessor
from .formats import AudioFormatProcessor
from .buffer import AudioRingBuffer
from .backends import ONNXVADBackend, VLLMVADBackend

__version__ = "0.1.0"
__author__ = "Cascade Team"
__license__ = "Apache-2.0"

__all__ = [
    # æ ¸å¿ƒå¤„ç†å™¨
    "VADProcessor",
    
    # é…ç½®ç±»å‹
    "AudioConfig", "VADConfig",
    
    # æ•°æ®ç±»å‹
    "AudioChunk", "VADResult", "PerformanceMetrics",
    
    # æšä¸¾ç±»å‹
    "AudioFormat", "VADBackend",
    
    # åç«¯å®ç°
    "ONNXVADBackend", "VLLMVADBackend",
    
    # è¾…åŠ©æ¨¡å—ï¼ˆé«˜çº§ç”¨æ³•ï¼‰
    "AudioFormatProcessor", "AudioRingBuffer",
]

# ä¾¿æ·å·¥å‚å‡½æ•°
def create_vad_processor(backend_type: str = "onnx", **kwargs) -> VADProcessor:
    """åˆ›å»ºVADå¤„ç†å™¨çš„ä¾¿æ·å‡½æ•°"""
    vad_config = VADConfig(backend=backend_type, **kwargs)
    audio_config = AudioConfig()
    return VADProcessor(vad_config, audio_config)

async def process_audio_file(file_path: str, **kwargs) -> list:
    """å¤„ç†éŸ³é¢‘æ–‡ä»¶çš„ä¾¿æ·å‡½æ•°"""
    processor = create_vad_processor(**kwargs)
    results = []
    async for result in processor.process_file(file_path):
        results.append(result)
    await processor.close()
    return results
```

### 2.2 æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[types.py<br/>é›¶ä¾èµ–] --> B[formats.py]
    A --> C[buffer.py]
    A --> D[backends/]
    A --> E[processor.py]
    
    B --> E
    C --> E
    D --> E
    
    F[_internal/] --> B
    F --> C
    F --> E
    
    G[å¤–éƒ¨ä¾èµ–] --> A
    G --> B
    G --> C
    G --> D
```

## 3. pyproject.toml é…ç½®è®¾è®¡

### 3.1 é¡¹ç›®å…ƒä¿¡æ¯é…ç½®

```toml
[build-system]
requires = ["hatchling>=1.20.0"]
build-backend = "hatchling.build"

[project]
name = "cascade"
version = "0.1.0"
description = "é«˜æ€§èƒ½å¼‚æ­¥å¹¶è¡ŒVADå¤„ç†åº“"
readme = "README.md"
license = {text = "Apache-2.0"}
authors = [
    {name = "Cascade Team", email = "team@cascade-vad.org"}
]
maintainers = [
    {name = "Cascade Team", email = "team@cascade-vad.org"}
]
keywords = [
    "voice-activity-detection", "vad", "audio-processing", 
    "speech", "async", "parallel", "high-performance"
]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: Apache Software License",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Topic :: Multimedia :: Sound/Audio :: Analysis",
    "Topic :: Scientific/Engineering :: Artificial Intelligence",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Typing :: Typed",
]
requires-python = ">=3.11"

dependencies = [
    "pydantic>=2.4.0,<3.0.0",
    "numpy>=1.24.0,<2.0.0",
    "scipy>=1.11.0,<2.0.0",
    "asyncio-throttle>=1.0.0,<2.0.0",
]

[project.optional-dependencies]
# å¼€å‘ä¾èµ–
dev = [
    "pytest>=7.4.0",
    "pytest-cov>=4.1.0",
    "pytest-asyncio>=0.21.0",
    "pytest-benchmark>=4.0.0",
    "pytest-xdist>=3.3.0",
    "black>=23.9.0",
    "isort>=5.12.0",
    "mypy>=1.6.0",
    "ruff>=0.1.0",
    "pre-commit>=3.5.0",
]

# æ–‡æ¡£ä¾èµ–
docs = [
    "mkdocs>=1.5.0",
    "mkdocs-material>=9.4.0",
    "mkdocstrings[python]>=0.23.0",
    "markdown-include>=0.8.0",
]

# VADåç«¯ä¾èµ–
onnx = [
    "onnxruntime>=1.16.0,<2.0.0",
]
vllm = [
    "vllm>=0.2.0,<1.0.0",
    "torch>=2.0.0,<3.0.0",
]

# å®Œæ•´å®‰è£…
full = [
    "cascade[dev,docs,onnx,vllm]"
]

[project.urls]
Documentation = "https://cascade-vad.readthedocs.io/"
Repository = "https://github.com/cascade-team/cascade"
Issues = "https://github.com/cascade-team/cascade/issues"
Changelog = "https://github.com/cascade-team/cascade/blob/main/CHANGELOG.md"

[project.scripts]
cascade-benchmark = "cascade.scripts.benchmark:main"
cascade-validate = "cascade.scripts.validate:main"
```

### 3.2 å·¥å…·é…ç½®

```toml
# ===== æµ‹è¯•é…ç½® =====
[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*", "*Test"]
python_functions = ["test_*"]
addopts = [
    "--strict-markers",
    "--strict-config",
    "--cov=cascade",
    "--cov-report=term-missing",
    "--cov-report=html:htmlcov",
    "--cov-report=xml",
    "--cov-fail-under=90",
    "--benchmark-skip",
]
markers = [
    "unit: å•å…ƒæµ‹è¯•",
    "integration: é›†æˆæµ‹è¯•",
    "benchmark: æ€§èƒ½åŸºå‡†æµ‹è¯•",
    "slow: æ…¢é€Ÿæµ‹è¯•",
    "audio: éœ€è¦éŸ³é¢‘æ–‡ä»¶çš„æµ‹è¯•",
]
asyncio_mode = "auto"
timeout = 300

# ===== è¦†ç›–ç‡é…ç½® =====
[tool.coverage.run]
source = ["cascade"]
omit = [
    "cascade/_internal/*",
    "tests/*",
    "examples/*",
    "scripts/*",
]
branch = true
parallel = true

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __repr__",
    "raise AssertionError",
    "raise NotImplementedError",
    "if __name__ == .__main__.:",
    "if TYPE_CHECKING:",
]
show_missing = true
skip_covered = false

# ===== ä»£ç æ ¼å¼åŒ– =====
[tool.black]
line-length = 88
target-version = ['py311', 'py312']
include = '\.pyi?$'
extend-exclude = '''
/(
    \.git
    | \.mypy_cache
    | \.pytest_cache
    | \.venv
    | build
    | dist
)/
'''

[tool.isort]
profile = "black"
multi_line_output = 3
line_length = 88
known_first_party = ["cascade"]
known_third_party = ["numpy", "scipy", "pydantic", "pytest"]
sections = ["FUTURE", "STDLIB", "THIRDPARTY", "FIRSTPARTY", "LOCALFOLDER"]

# ===== ç±»å‹æ£€æŸ¥ =====
[tool.mypy]
python_version = "3.11"
strict = true
warn_unused_ignores = true
warn_redundant_casts = true
warn_unused_configs = true
disallow_untyped_defs = true
disallow_incomplete_defs = true
check_untyped_defs = true
disallow_untyped_decorators = true
no_implicit_optional = true
warn_return_any = true
show_error_codes = true
show_column_numbers = true

[[tool.mypy.overrides]]
module = [
    "scipy.*",
    "onnxruntime.*",
    "vllm.*",
]
ignore_missing_imports = true

# ===== Ruffé…ç½® =====
[tool.ruff]
line-length = 88
target-version = "py311"
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "B",   # flake8-bugbear
    "C4",  # flake8-comprehensions
    "UP",  # pyupgrade
    "A",   # flake8-builtins
    "PL",  # pylint
    "SIM", # flake8-simplify
]
ignore = [
    "E501",   # line too long, handled by black
    "B008",   # do not perform function calls in argument defaults
    "PLR0913", # too many arguments to function call
]

[tool.ruff.per-file-ignores]
"tests/*" = ["PLR2004"]  # Magic value used in comparison

# ===== Hatché…ç½® =====
[tool.hatch.build.targets.wheel]
packages = ["cascade"]

[tool.hatch.build.targets.sdist]
exclude = [
    "/.github",
    "/.vscode",
    "/tests",
    "/examples",
    "/docs",
    "/scripts",
]

[tool.hatch.version]
path = "cascade/__init__.py"
```

## 4. å¼€å‘ç¯å¢ƒé…ç½®

### 4.1 .devcontainer é…ç½®

```json
{
    "name": "Cascade Development",
    "image": "python:3.12-slim",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/github-cli:1": {}
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-python.mypy-type-checker",
                "charliermarsh.ruff",
                "ms-python.black-formatter",
                "ms-python.isort",
                "ms-vscode.test-adapter-converter",
                "littlefoxteam.vscode-python-test-adapter",
                "ms-vscode.makefile-tools"
            ],
            "settings": {
                "python.defaultInterpreterPath": "/usr/local/bin/python",
                "python.formatting.provider": "black",
                "python.linting.enabled": true,
                "python.linting.ruffEnabled": true,
                "python.analysis.typeCheckingMode": "strict",
                "files.associations": {
                    "*.toml": "toml"
                }
            }
        }
    },
    "postCreateCommand": "pip install -e '.[dev]' && pre-commit install",
    "forwardPorts": [8000],
    "mounts": [
        "source=${localWorkspaceFolder}/.cache,target=/workspace/.cache,type=bind"
    ]
}
```

### 4.2 GitHub Actions å·¥ä½œæµ

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

env:
  PYTHON_VERSION: "3.12"

jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest]
        python-version: ["3.11", "3.12"]
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v4
      with:
        python-version: ${{ matrix.python-version }}
        cache: 'pip'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -e ".[dev]"
    
    - name: Lint with ruff
      run: ruff check cascade tests examples
    
    - name: Format check with black
      run: black --check cascade tests examples
    
    - name: Type check with mypy
      run: mypy cascade
    
    - name: Run unit tests
      run: pytest tests/unit/ -v --cov --cov-report=xml
    
    - name: Run integration tests
      run: pytest tests/integration/ -v
    
    - name: Upload coverage reports
      uses: codecov/codecov-action@v3
      with:
        file: ./coverage.xml
        flags: unittests
        name: codecov-umbrella

  performance:
    runs-on: ubuntu-latest
    needs: test
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
    
    - name: Install dependencies
      run: |
        pip install -e ".[dev,onnx]"
    
    - name: Run performance benchmarks
      run: pytest tests/benchmarks/ --benchmark-json=benchmark.json
    
    - name: Store benchmark results
      uses: benchmark-action/github-action-benchmark@v1
      with:
        tool: 'pytest'
        output-file-path: benchmark.json
        github-token: ${{ secrets.GITHUB_TOKEN }}
        auto-push: true

  docs:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
    
    - name: Install dependencies
      run: |
        pip install -e ".[docs]"
    
    - name: Build documentation
      run: mkdocs build --strict
    
    - name: Deploy documentation
      if: github.ref == 'refs/heads/main'
      run: mkdocs gh-deploy --force
```

### 4.3 å¼€å‘è„šæœ¬

```python
# scripts/setup_dev.py
"""å¼€å‘ç¯å¢ƒè®¾ç½®è„šæœ¬"""
import subprocess
import sys
from pathlib import Path

def setup_development_environment():
    """è®¾ç½®å¼€å‘ç¯å¢ƒ"""
    print("ğŸš€ è®¾ç½®Cascadeå¼€å‘ç¯å¢ƒ...")
    
    # å®‰è£…å¼€å‘ä¾èµ–
    print("ğŸ“¦ å®‰è£…å¼€å‘ä¾èµ–...")
    subprocess.run([sys.executable, "-m", "pip", "install", "-e", ".[dev]"], check=True)
    
    # è®¾ç½®pre-commit hooks
    print("ğŸ”§ è®¾ç½®pre-commit hooks...")
    subprocess.run(["pre-commit", "install"], check=True)
    
    # åˆ›å»ºå¿…è¦çš„ç›®å½•
    print("ğŸ“ åˆ›å»ºé¡¹ç›®ç›®å½•...")
    directories = [
        "tests/fixtures/audio_samples",
        "tests/fixtures/expected_results",
        "examples/audio_files",
        "docs/api",
        ".cache"
    ]
    
    for dir_path in directories:
        Path(dir_path).mkdir(parents=True, exist_ok=True)
    
    print("âœ… å¼€å‘ç¯å¢ƒè®¾ç½®å®Œæˆï¼")
    print("\nğŸ¯ ä¸‹ä¸€æ­¥:")
    print("  - è¿è¡Œæµ‹è¯•: python -m pytest")
    print("  - å¯åŠ¨æ–‡æ¡£æœåŠ¡: mkdocs serve")
    print("  - æ£€æŸ¥ä»£ç è´¨é‡: ruff check cascade")

if __name__ == "__main__":
    setup_development_environment()
```

## 5. ä»£ç è´¨é‡ä¿éšœ

### 5.1 pre-commit é…ç½®

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-toml
      - id: check-merge-conflict
      - id: debug-statements

  - repo: https://github.com/psf/black
    rev: 23.9.1
    hooks:
      - id: black
        language_version: python3.12

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort

  - repo: https://github.com/charliermarsh/ruff-pre-commit
    rev: v0.1.0
    hooks:
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.6.1
    hooks:
      - id: mypy
        additional_dependencies: [pydantic, numpy, types-requests]
```

### 5.2 è´¨é‡é—¨ç¦

- **ä»£ç è¦†ç›–ç‡**: >90%
- **ç±»å‹æ£€æŸ¥**: mypy strict modeé€šè¿‡
- **ä»£ç é£æ ¼**: black + isort + ruff
- **æ€§èƒ½å›å½’**: å»¶è¿Ÿå¢é•¿<10%
- **æ–‡æ¡£å®Œæ•´æ€§**: æ‰€æœ‰å…¬å¼€APIå¿…é¡»æœ‰æ–‡æ¡£

## 6. æ–‡æ¡£ç”Ÿæˆé…ç½®

### 6.1 MkDocs é…ç½®

```yaml
# mkdocs.yml
site_name: Cascade
site_description: é«˜æ€§èƒ½å¼‚æ­¥å¹¶è¡ŒVADå¤„ç†åº“
site_url: https://cascade-vad.readthedocs.io/
repo_url: https://github.com/cascade-team/cascade
repo_name: cascade-team/cascade

theme:
  name: material
  palette:
    - scheme: default
      primary: blue
      accent: blue
      toggle:
        icon: material/brightness-7
        name: Switch to dark mode
    - scheme: slate
      primary: blue
      accent: blue
      toggle:
        icon: material/brightness-4
        name: Switch to light mode
  features:
    - navigation.tabs
    - navigation.sections
    - navigation.expand
    - navigation.top
    - search.highlight
    - content.code.copy

nav:
  - é¦–é¡µ: index.md
  - å¿«é€Ÿå¼€å§‹: tutorials/getting_started.md
  - APIæ–‡æ¡£: api/
  - æ¶æ„è®¾è®¡: architecture/
  - æ€§èƒ½æŒ‡å—: tutorials/performance_guide.md
  - è´¡çŒ®æŒ‡å—: contributing.md

plugins:
  - search
  - mkdocstrings:
      handlers:
        python:
          options:
            docstring_style: google
            show_source: false
            show_signature_annotations: true

markdown_extensions:
  - admonition
  - codehilite
  - footnotes
  - toc:
      permalink: true
  - pymdownx.arithmatex
  - pymdownx.betterem
  - pymdownx.caret
  - pymdownx.critic
  - pymdownx.details
  - pymdownx.inlinehilite
  - pymdownx.keys
  - pymdownx.magiclink
  - pymdownx.mark
  - pymdownx.smartsymbols
  - pymdownx.superfences:
      custom_fences:
        - name: mermaid
          class: mermaid
          format: !!python/name:pymdownx.superfences.fence_code_format
  - pymdownx.tasklist:
      custom_checkbox: true
  - pymdownx.tilde
```

## 7. æ€»ç»“

### 7.1 é¡¹ç›®ç»“æ„ç‰¹ç‚¹

- **æ¨¡å—åŒ–è®¾è®¡**: åŠŸèƒ½æ¨¡å—ä¼˜å…ˆï¼Œæ¸…æ™°çš„è¾¹ç•Œ
- **å¼€å‘è€…å‹å¥½**: å®Œæ•´çš„å·¥å…·é“¾å’Œè‡ªåŠ¨åŒ–æµç¨‹
- **è´¨é‡ä¿éšœ**: ä¸¥æ ¼çš„ä»£ç è´¨é‡é—¨ç¦
- **æ–‡æ¡£é©±åŠ¨**: è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆå’Œç»´æŠ¤
- **æ€§èƒ½ä¼˜å…ˆ**: å†…ç½®æ€§èƒ½ç›‘æ§å’ŒåŸºå‡†æµ‹è¯•

### 7.2 å¼€å‘å·¥ä½œæµ

1. **ç¯å¢ƒè®¾ç½®**: `python scripts/setup_dev.py`
2. **å¼€å‘**: ä½¿ç”¨devcontaineræˆ–æœ¬åœ°ç¯å¢ƒ
3. **æäº¤**: pre-commitè‡ªåŠ¨æ£€æŸ¥ä»£ç è´¨é‡
4. **æµ‹è¯•**: CI/CDè‡ªåŠ¨è¿è¡Œå…¨é¢æµ‹è¯•
5. **å‘å¸ƒ**: è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†å’ŒåŒ…å‘å¸ƒ

### 7.3 ä¸‹ä¸€æ­¥å®æ–½

1. åˆ›å»ºåŸºç¡€é¡¹ç›®ç»“æ„
2. å®æ–½æ ¸å¿ƒé…ç½®æ–‡ä»¶
3. è®¾ç½®å¼€å‘ç¯å¢ƒå’ŒCI/CD
4. å®ç°æ ¸å¿ƒæ¨¡å—éª¨æ¶
5. å®Œå–„æµ‹è¯•å’Œæ–‡æ¡£ä½“ç³»

è¿™ä¸ªè®¾è®¡ç¡®ä¿äº†Cascadeé¡¹ç›®çš„**å¯ç»´æŠ¤æ€§**ã€**å¯æ‰©å±•æ€§**å’Œ**å¼€å‘è€…ä½“éªŒ**ï¼Œä¸ºé¡¹ç›®çš„é•¿æœŸå‘å±•å¥ å®šäº†åšå®åŸºç¡€ã€‚